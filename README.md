# Data-plot-and-EEF-calculate
# 程式功能列表

## 1. CSV 檔案處理
- **選擇檔案**：使用者可以選擇 CSV 檔案，程式會檢查是否包含 `Date` 和 `Time` 欄位，並將其合併為 `datetime` 欄位。
- **檢查欄位**：檢查是否有 `U(V)`、`I(A)`、`P(W)` 和 `WP(Wh)` 欄位，若缺少則自動補上並填入 `0`。

## 2. 日期與時間增減功能
- **開始與結束日期/時間輸入框**：使用者可以手動輸入，或使用快捷鍵（`Ctrl + ↑` 或 `Ctrl + ↓`）來增減日期或時間。
- **日期增減單位**：天。
- **時間增減單位**：小時。

## 3. 統計計算
- **計算平均值**：計算指定日期時間範圍內的數值欄位平均值。
- **計算電力啟停周期**：
  - 計算 `P(W)` 大於等於 `3W` 的啟停周期次數。
  - 計算大於等於 `3W` 和小於 `3W` 的平均持續時間。
  - 計算大於等於 `3W` 的百分比。
- **計算電力消耗**：
  - 計算 `WP(Wh)` 欄位的差值。
  - 使用線性法推算 24 小時的電力消耗。

## 4. 繪製圖表
- **溫度資料圖表**：
  - 繪製溫度相關欄位的折線圖。
- **電力資料圖表**：
  - 繪製 `P(W)`（功率）、`U(V)`（電壓）、`I(A)`（電流）的多軸圖表。
  - 支援多個 Y 軸（左側 Y 軸為功率，右側 Y 軸分別為電壓與電流）。

## 5. 結果顯示與儲存
- **多行文字框顯示結果**：計算結果會顯示在多行文字框中。
- **儲存結果**：使用者可以將多行文字框的內容儲存為 `.txt` 檔案。

## 6. 設定管理
- **儲存設定**：將 CSV 檔案路徑與圖表標題儲存到 `config.ini` 檔案。
- **載入設定**：從 `config.ini` 檔案載入設定。

## 7. 錯誤處理
- **檔案格式檢查**：檢查 CSV 檔案是否包含必要欄位，若缺少則顯示錯誤訊息。
- **日期時間格式檢查**：檢查日期與時間格式是否正確，若格式錯誤則顯示錯誤訊息。
- **例外處理**：在檔案處理、統計計算或繪圖過程中發生錯誤時，顯示錯誤訊息。

## 8. 介面設計
- **主視窗**：包含檔案選擇、圖表標題輸入、日期時間輸入框、多行文字框等元件。
- **按鈕功能**：
  - 「選擇檔案」按鈕：選擇 CSV 檔案。
  - 「繪製圖表」按鈕：繪製溫度與電力資料圖表。
  - 「計算平均值」按鈕：計算統計數據。
  - 「儲存結果」按鈕：將結果儲存為文字檔。
